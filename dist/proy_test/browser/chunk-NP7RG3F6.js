import{a as he}from"./chunk-I6ICULGC.js";import{b as ye,c as N,d as Se,e as we,h as Pe,k as Ee,l as ke,n as Te,o as Ie,r as Ve,s as oe,t as Fe}from"./chunk-C56EV6ZL.js";import{a as W,b as ne}from"./chunk-CS5JLY4K.js";import{a as ie}from"./chunk-6WUTALT2.js";import{$a as xe,A as F,Aa as c,Ba as I,Ca as g,Da as ge,G as b,H as C,I as x,J as k,Ja as A,Ka as G,M as z,Ma as fe,P as B,Q as V,S as $,U as ue,V as Q,Wa as _,Z as r,ca as y,db as M,ea as u,eb as j,f as Y,fa as Z,fb as ee,ga as v,ha as X,ia as T,k as K,ma as s,na as _e,o as J,oa as R,pa as S,qa as w,qb as ve,ra as o,rb as be,s as U,sa as a,ta as p,ua as h,ub as Ce,va as f,wa as d,wb as te,z as P}from"./chunk-7RPVYQIG.js";import{a as D,b as O}from"./chunk-6MDQTQU3.js";var Ae=(i,t)=>t.url;function Re(i,t){if(i&1){let e=h();o(0,"img",8),f("click",function(){b(e);let l=d();return C(l.abrirZoom())}),a()}if(i&2){let e=d();v("ngSrc",e.imagenPrincipalCompleta())("alt",e.imagenPrincipalAlt())("width",600)("height",600)}}function De(i,t){i&1&&(o(0,"div",3),x(),o(1,"svg",9),p(2,"path",10),a()())}function Oe(i,t){if(i&1){let e=h();o(0,"button",11),f("click",function(){b(e);let l=d();return C(l.abrirZoom())}),x(),o(1,"svg",12),p(2,"path",13),a()()}}function Ge(i,t){if(i&1){let e=h();o(0,"div",14)(1,"button",15),f("click",function(){b(e);let l=d();return C(l.imagenAnterior())}),x(),o(2,"svg",12),p(3,"path",16),a()()(),k(),o(4,"div",17)(5,"button",18),f("click",function(){b(e);let l=d();return C(l.imagenSiguiente())}),x(),o(6,"svg",12),p(7,"path",19),a()()()}if(i&2){let e=d();r(),v("disabled",e.imagenSeleccionada()===0),r(4),v("disabled",e.imagenSeleccionada()===e.imagenes().length-1)}}function je(i,t){i&1&&p(0,"div",23)}function $e(i,t){if(i&1){let e=h();o(0,"button",21),f("click",function(){let l=b(e).$index,m=d(2);return C(m.seleccionarImagen(l))}),p(1,"img",22),u(2,je,1,0,"div",23),a()}if(i&2){let e=t.$implicit,n=t.$index,l=d(2);T("border-blue-500",l.imagenSeleccionada()===n)("border-gray-200",l.imagenSeleccionada()!==n),Z("aria-label","Ver "+e.alt),r(),v("ngSrc",l.getImagenUrl(e.url))("alt",e.alt)("width",100)("height",100),r(),s(l.imagenSeleccionada()===n?2:-1)}}function Ne(i,t){if(i&1&&(o(0,"div",5),S(1,$e,3,10,"button",20,Ae),a()),i&2){let e=d();r(),w(e.imagenes())}}function Le(i,t){if(i&1){let e=h();o(0,"button",25),f("click",function(){let l=b(e).$index,m=d(2);return C(m.seleccionarImagen(l))}),a()}if(i&2){let e=t.$index,n=d(2);T("bg-blue-500",n.imagenSeleccionada()===e)("bg-gray-300",n.imagenSeleccionada()!==e),Z("aria-label","Ir a imagen "+(e+1))}}function ze(i,t){if(i&1&&(o(0,"div",6),S(1,Le,1,5,"button",24,Ae),a()),i&2){let e=d();r(),w(e.imagenes())}}function Be(i,t){if(i&1){let e=h();o(0,"button",32),f("click",function(l){return b(e),d(2).imagenAnterior(),C(l.stopPropagation())}),x(),o(1,"svg",30),p(2,"path",16),a()(),k(),o(3,"button",33),f("click",function(l){return b(e),d(2).imagenSiguiente(),C(l.stopPropagation())}),x(),o(4,"svg",30),p(5,"path",19),a()()}if(i&2){let e=d(2);v("disabled",e.imagenSeleccionada()===0),r(3),v("disabled",e.imagenSeleccionada()===e.imagenes().length-1)}}function He(i,t){if(i&1){let e=h();o(0,"div",26),f("click",function(){b(e);let l=d();return C(l.cerrarZoom())})("keydown.escape",function(){b(e);let l=d();return C(l.cerrarZoom())}),o(1,"div",27)(2,"img",28),f("click",function(l){return b(e),C(l.stopPropagation())}),a(),o(3,"button",29),f("click",function(){b(e);let l=d();return C(l.cerrarZoom())}),x(),o(4,"svg",30),p(5,"path",31),a()(),u(6,Be,6,2),a()()}if(i&2){let e=d();r(2),v("src",e.imagenPrincipalCompleta(),Q)("alt",e.imagenPrincipalAlt()),r(4),s(e.imagenes().length>1?6:-1)}}var ae=class i{platformId=P($);imagenes=V.required();imagenSeleccionada=V(0);producto=V.required();imagenCambiada=B();_mostrarZoom=y(!1);mostrarZoom=_(()=>this._mostrarZoom());imagenPrincipalCompleta=_(()=>{let t=this.imagenes(),e=this.imagenSeleccionada();if(t.length===0)return"";let n=t[e];return n?this.getImagenUrl(n.url):""});imagenPrincipalAlt=_(()=>{let t=this.imagenes(),e=this.imagenSeleccionada();if(t.length===0)return"";let n=t[e];return n?n.alt:""});getImagenUrl(t){if(!t)return"";if(t.startsWith("http://")||t.startsWith("https://"))return t;let e=ie.urlDominioApi.replace("/api",""),n=t.startsWith("/")?t:`/${t}`;return`${e}${n}`}seleccionarImagen(t){this.imagenCambiada.emit(t)}imagenAnterior(){let t=this.imagenSeleccionada();t>0&&this.seleccionarImagen(t-1)}imagenSiguiente(){let t=this.imagenSeleccionada(),e=this.imagenes().length;t<e-1&&this.seleccionarImagen(t+1)}abrirZoom(){j(this.platformId)&&(this._mostrarZoom.set(!0),document.body.style.overflow="hidden")}cerrarZoom(){j(this.platformId)&&(this._mostrarZoom.set(!1),document.body.style.overflow="")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-galeria-imagenes"]],inputs:{imagenes:[1,"imagenes"],imagenSeleccionada:[1,"imagenSeleccionada"],producto:[1,"producto"]},outputs:{imagenCambiada:"imagenCambiada"},standalone:!0,features:[A],decls:9,vars:6,consts:[[1,"space-y-4"],[1,"relative","aspect-square","bg-white","rounded-lg","border","border-gray-200","overflow-hidden","group"],["priority","true",1,"w-full","h-full","object-contain","p-4","transition-transform","duration-300","group-hover:scale-105",3,"ngSrc","alt","width","height"],[1,"w-full","h-full","flex","items-center","justify-center","bg-gray-100"],["type","button","aria-label","Ampliar imagen",1,"absolute","top-4","right-4","bg-white/80","hover:bg-white","text-gray-700","p-2","rounded-full","shadow-md","transition-all","duration-200","opacity-0","group-hover:opacity-100"],[1,"grid","grid-cols-4","gap-2"],[1,"flex","justify-center","space-x-2"],[1,"fixed","inset-0","z-50","bg-black","bg-opacity-90","flex","items-center","justify-center","p-4"],["priority","true",1,"w-full","h-full","object-contain","p-4","transition-transform","duration-300","group-hover:scale-105",3,"click","ngSrc","alt","width","height"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-24","h-24","text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],["type","button","aria-label","Ampliar imagen",1,"absolute","top-4","right-4","bg-white/80","hover:bg-white","text-gray-700","p-2","rounded-full","shadow-md","transition-all","duration-200","opacity-0","group-hover:opacity-100",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"],[1,"absolute","inset-y-0","left-4","flex","items-center"],["type","button","aria-label","Imagen anterior",1,"bg-white/80","hover:bg-white","text-gray-700","p-2","rounded-full","shadow-md","transition-all","duration-200","disabled:opacity-50","disabled:cursor-not-allowed","opacity-0","group-hover:opacity-100",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"absolute","inset-y-0","right-4","flex","items-center"],["type","button","aria-label","Imagen siguiente",1,"bg-white/80","hover:bg-white","text-gray-700","p-2","rounded-full","shadow-md","transition-all","duration-200","disabled:opacity-50","disabled:cursor-not-allowed","opacity-0","group-hover:opacity-100",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],["type","button",1,"relative","aspect-square","bg-white","rounded-lg","border-2","overflow-hidden","transition-all","duration-200","hover:border-gray-300",3,"border-blue-500","border-gray-200"],["type","button",1,"relative","aspect-square","bg-white","rounded-lg","border-2","overflow-hidden","transition-all","duration-200","hover:border-gray-300",3,"click"],["loading","lazy",1,"w-full","h-full","object-contain","p-1",3,"ngSrc","alt","width","height"],[1,"absolute","inset-0","border-2","border-blue-500","rounded-lg","pointer-events-none"],["type","button",1,"w-2","h-2","rounded-full","transition-all","duration-200",3,"bg-blue-500","bg-gray-300"],["type","button",1,"w-2","h-2","rounded-full","transition-all","duration-200",3,"click"],[1,"fixed","inset-0","z-50","bg-black","bg-opacity-90","flex","items-center","justify-center","p-4",3,"click","keydown.escape"],[1,"relative","max-w-4xl","max-h-full"],[1,"max-w-full","max-h-full","object-contain",3,"click","src","alt"],["type","button","aria-label","Cerrar zoom",1,"absolute","top-4","right-4","bg-white/20","hover:bg-white/30","text-white","p-2","rounded-full","transition-all","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["type","button","aria-label","Imagen anterior",1,"absolute","left-4","top-1/2","transform","-translate-y-1/2","bg-white/20","hover:bg-white/30","text-white","p-3","rounded-full","transition-all","duration-200","disabled:opacity-50",3,"click","disabled"],["type","button","aria-label","Imagen siguiente",1,"absolute","right-4","top-1/2","transform","-translate-y-1/2","bg-white/20","hover:bg-white/30","text-white","p-3","rounded-full","transition-all","duration-200","disabled:opacity-50",3,"click","disabled"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1),u(2,Re,1,4,"img",2)(3,De,3,0,"div",3)(4,Oe,3,0,"button",4)(5,Ge,8,2),a(),u(6,Ne,3,0,"div",5)(7,ze,3,0,"div",6),a(),u(8,He,7,3,"div",7)),e&2&&(r(2),s(n.imagenPrincipalCompleta()?2:3),r(2),s(n.imagenPrincipalCompleta()?4:-1),r(),s(n.imagenes().length>1?5:-1),r(),s(n.imagenes().length>1?6:-1),r(),s(n.imagenes().length>1?7:-1),r(),s(n.mostrarZoom()?8:-1))},dependencies:[M,ee],styles:["img[_ngcontent-%COMP%]{transition:transform .3s ease-in-out}.group[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:zoom-in}.group[_ngcontent-%COMP%]:hover   button[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.fixed[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}"]})};var Ue=(i,t)=>t.meses;function Ze(i,t){if(i&1&&(o(0,"p",2),c(1),a()),i&2){let e=d();r(),g(" ",e.producto().marca," ")}}function We(i,t){i&1&&c(0," En stock ")}function Ye(i,t){if(i&1&&c(0),i&2){let e=d();g(" \xDAltimas ",e.producto().stock," unidades ")}}function Ke(i,t){i&1&&c(0," Sin stock ")}function Je(i,t){if(i&1&&(o(0,"div",9)(1,"span"),c(2,"Categor\xEDa:"),a(),o(3,"span",46),c(4),a()()),i&2){let e,n=d();r(4),I((e=n.producto().categoria)==null?null:e.nombre)}}function Qe(i,t){if(i&1&&(o(0,"span",49),c(1),a()),i&2){let e=d(2);r(),g(" ",e.porcentajeDescuento(),"% OFF ")}}function Xe(i,t){if(i&1&&(o(0,"div",47)(1,"span",48),c(2),a(),u(3,Qe,2,1,"span",49),a(),o(4,"div",7)(5,"span",50),c(6),a(),o(7,"span",51),c(8),a()()),i&2){let e=d();r(2),g(" ",e.precioOfertaFormateado()," "),r(),s(e.porcentajeDescuento()?3:-1),r(3),g(" ",e.precioFormateado()," "),r(2),g(" Ahorras ",e.ahorroFormateado()," ")}}function et(i,t){if(i&1&&(o(0,"div",11),c(1),a()),i&2){let e=d();r(),g(" ",e.precioFormateado()," ")}}function tt(i,t){if(i&1&&(o(0,"option",17),c(1),a()),i&2){let e=t.$implicit;v("value",e.meses),r(),I(e.label)}}function it(i,t){if(i&1&&(o(0,"div",24)(1,"p",52),c(2),a()()),i&2){let e=d();r(2),g(" ",e.producto().descripcion," ")}}function nt(i,t){if(i&1&&(o(0,"span",35),c(1),a()),i&2){let e=d();r(),g(" ",e.producto().stock," disponibles ")}}function ot(i,t){i&1&&(x(),o(0,"svg",53),p(1,"path",45),a(),c(2," Agregando... "))}function at(i,t){i&1&&c(0," Sin Stock ")}function rt(i,t){i&1&&c(0," Agregar al Carrito ")}function lt(i,t){if(i&1&&(x(),o(0,"svg",54),p(1,"path",55),a(),u(2,at,1,0)(3,rt,1,0)),i&2){let e=d();r(2),s(e.producto().stock===0?2:3)}}function ct(i,t){if(i&1){let e=h();o(0,"button",56),f("click",function(){b(e);let l=d();return C(l.comprarAhora())}),x(),o(1,"svg",54),p(2,"path",57),a(),c(3," Comprar Ahora "),a()}}function dt(i,t){if(i&1&&(o(0,"div",39),x(),o(1,"svg",58),p(2,"path",59),a(),k(),o(3,"div")(4,"p",42),c(5,"Garant\xEDa"),a(),o(6,"p",43),c(7),a()()()),i&2){let e=d();r(7),I(e.producto().garantia)}}var re=class i{platformId=P($);producto=V.required();precioFormateado=V.required();precioOfertaFormateado=V(null);porcentajeDescuento=V(null);agregarAlCarrito=B();_cantidad=y(1);_agregandoCarrito=y(!1);_mesesSeleccionados=y(3);cantidad=_(()=>this._cantidad());agregandoCarrito=_(()=>this._agregandoCarrito());mesesSeleccionados=_(()=>this._mesesSeleccionados());opcionesCuotas=[{meses:3,label:"3 meses"},{meses:6,label:"6 meses"},{meses:9,label:"9 meses"},{meses:12,label:"12 meses"},{meses:18,label:"18 meses"},{meses:24,label:"24 meses"}];ahorroFormateado=_(()=>{let t=this.producto();if(!this.precioOfertaFormateado()||!t.precio_oferta)return"";let n=t.precio-t.precio_oferta;return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:0,maximumFractionDigits:0}).format(n)});cuotaMensual=_(()=>{let t=this.producto(),e=this._mesesSeleccionados(),n=t.precio_oferta||t.precio,l=1;switch(e){case 3:l=1.05;break;case 6:l=1.12;break;case 9:l=1.18;break;case 12:l=1.25;break;case 18:l=1.35;break;case 24:l=1.45;break}let E=n*l/e;return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:2,maximumFractionDigits:2}).format(E)});incrementarCantidad(){let t=this._cantidad(),e=this.producto().stock;t<e&&this._cantidad.set(t+1)}decrementarCantidad(){let t=this._cantidad();t>1&&this._cantidad.set(t-1)}actualizarCantidad(t){let e=t.target,n=parseInt(e.value,10),l=this.producto().stock;!isNaN(n)&&n>=1&&n<=l?this._cantidad.set(n):e.value=this._cantidad().toString()}onAgregarAlCarrito(){let t=this.producto(),e=this._cantidad();t.stock!==0&&(this._agregandoCarrito.set(!0),setTimeout(()=>{this.agregarAlCarrito.emit({productoId:t.id,cantidad:e}),this._agregandoCarrito.set(!1),j(this.platformId)&&console.log(`Producto ${t.nombre} agregado al carrito (${e} unidades)`)},1e3))}comprarAhora(){this.onAgregarAlCarrito(),setTimeout(()=>{console.log("Redirigir al checkout")},1500)}onCambiarMeses(t){let e=t.target,n=parseInt(e.value,10);isNaN(n)||this._mesesSeleccionados.set(n)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-informacion-producto"]],inputs:{producto:[1,"producto"],precioFormateado:[1,"precioFormateado"],precioOfertaFormateado:[1,"precioOfertaFormateado"],porcentajeDescuento:[1,"porcentajeDescuento"]},outputs:{agregarAlCarrito:"agregarAlCarrito"},standalone:!0,features:[A],decls:78,vars:25,consts:[[1,"space-y-6"],[1,"space-y-3"],[1,"text-sm","font-medium","text-blue-600","uppercase","tracking-wide"],[1,"text-2xl","md:text-3xl","font-bold","text-gray-900","leading-tight"],[1,"flex","flex-wrap","items-center","gap-4","text-sm","text-gray-600"],[1,"font-medium"],[1,"text-gray-300"],[1,"flex","items-center","gap-2"],[1,"w-2","h-2","rounded-full"],[1,"flex","items-center","gap-2","text-sm","text-gray-600"],[1,"space-y-2"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-gray-50","rounded-lg","p-4","space-y-3"],[1,"text-sm","font-medium","text-gray-900"],[1,"flex","flex-col","sm:flex-row","gap-4","items-start","sm:items-center"],[1,"relative"],[1,"appearance-none","bg-white","border","border-gray-300","rounded-lg","px-4","py-2","pr-8","text-sm","font-medium","text-gray-700","hover:border-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","cursor-pointer",3,"change","value"],[3,"value"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-2","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"text-xl","font-bold","text-blue-600"],[1,"text-sm","text-gray-600","font-medium"],[1,"text-xs","text-gray-500"],[1,"prose","prose-gray","prose-sm","max-w-none"],[1,"space-y-4"],[1,"flex","items-center","gap-4"],["for","cantidad",1,"text-sm","font-medium","text-gray-700"],[1,"flex","items-center","border","border-gray-300","rounded-lg"],["type","button","aria-label","Decrementar cantidad",1,"p-2","text-gray-500","hover:text-gray-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","duration-200",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 12H4"],["id","cantidad","type","number","readonly","",1,"w-16","text-center","border-0","focus:ring-0","focus:outline-none",3,"input","value","min","max"],["type","button","aria-label","Incrementar cantidad",1,"p-2","text-gray-500","hover:text-gray-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","duration-200",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"text-sm","text-gray-500"],["type","button",1,"w-full","bg-blue-600","hover:bg-blue-700","text-white","font-medium","py-3","px-6","rounded-lg","transition-colors","duration-200","disabled:bg-gray-300","disabled:cursor-not-allowed","flex","items-center","justify-center","gap-2",3,"click","disabled"],["type","button",1,"w-full","bg-gray-100","hover:bg-gray-200","text-gray-900","font-medium","py-3","px-6","rounded-lg","transition-colors","duration-200","flex","items-center","justify-center","gap-2"],[1,"border-t","border-gray-200","pt-6","space-y-4"],[1,"flex","items-start","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600","mt-0.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"font-medium","text-gray-900"],[1,"text-sm","text-gray-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600","mt-0.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"font-medium","text-blue-600"],[1,"flex","items-center","gap-3"],[1,"text-3xl","font-bold","text-red-600"],[1,"bg-red-100","text-red-800","text-sm","font-medium","px-2","py-1","rounded"],[1,"text-lg","text-gray-500","line-through"],[1,"text-sm","text-green-600","font-medium"],[1,"text-gray-600","leading-relaxed"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","animate-spin"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m0 0h7M17 18a2 2 0 100 4 2 2 0 000-4zm-8 0a2 2 0 100 4 2 2 0 000-4z"],["type","button",1,"w-full","bg-gray-100","hover:bg-gray-200","text-gray-900","font-medium","py-3","px-6","rounded-lg","transition-colors","duration-200","flex","items-center","justify-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600","mt-0.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"]],template:function(e,n){if(e&1&&(o(0,"div",0)(1,"div",1),u(2,Ze,2,1,"p",2),o(3,"h1",3),c(4),a(),o(5,"div",4)(6,"span"),c(7,"SKU: "),o(8,"span",5),c(9),a()(),o(10,"span",6),c(11,"|"),a(),o(12,"div",7),p(13,"div",8),o(14,"span"),u(15,We,1,0)(16,Ye,1,1)(17,Ke,1,0),a()()(),u(18,Je,5,1,"div",9),a(),o(19,"div",10),u(20,Xe,9,4)(21,et,2,1,"div",11),a(),o(22,"div",12)(23,"h3",13),c(24," Simula el valor de tu cuota "),a(),o(25,"div",14)(26,"div",15)(27,"select",16),f("change",function(m){return n.onCambiarMeses(m)}),S(28,tt,2,2,"option",17,Ue),a(),o(30,"div",18),x(),o(31,"svg",19),p(32,"path",20),a()()(),k(),o(33,"div",7)(34,"span",21),c(35),a(),o(36,"span",22),c(37,"Mensual"),a()()(),o(38,"div",23)(39,"p"),c(40," * Cuotas calculadas con intereses. Solo para fines informativos. "),a()()(),u(41,it,3,1,"div",24),o(42,"div",25)(43,"div",26)(44,"label",27),c(45," Cantidad: "),a(),o(46,"div",28)(47,"button",29),f("click",function(){return n.decrementarCantidad()}),x(),o(48,"svg",30),p(49,"path",31),a()(),k(),o(50,"input",32),f("input",function(m){return n.actualizarCantidad(m)}),a(),o(51,"button",33),f("click",function(){return n.incrementarCantidad()}),x(),o(52,"svg",30),p(53,"path",34),a()()(),u(54,nt,2,1,"span",35),a(),k(),o(55,"div",1)(56,"button",36),f("click",function(){return n.onAgregarAlCarrito()}),u(57,ot,3,0)(58,lt,4,1),a(),u(59,ct,4,0,"button",37),a()(),o(60,"div",38)(61,"div",39),x(),o(62,"svg",40),p(63,"path",41),a(),k(),o(64,"div")(65,"p",42),c(66,"Env\xEDo gratuito"),a(),o(67,"p",43),c(68,"En compras mayores a S/ 99"),a()()(),u(69,dt,8,1,"div",39),o(70,"div",39),x(),o(71,"svg",44),p(72,"path",45),a(),k(),o(73,"div")(74,"p",42),c(75,"Devoluciones f\xE1ciles"),a(),o(76,"p",43),c(77," 30 d\xEDas para cambios y devoluciones "),a()()()()()),e&2){let l;r(2),s(n.producto().marca?2:-1),r(2),g(" ",n.producto().nombre," "),r(5),I(n.producto().sku),r(4),T("bg-green-400",n.producto().stock>5)("bg-yellow-400",n.producto().stock>0&&n.producto().stock<=5)("bg-red-400",n.producto().stock===0),r(2),s(n.producto().stock>5?15:n.producto().stock>0?16:17),r(3),s((l=n.producto().categoria)!=null&&l.nombre?18:-1),r(2),s(n.precioOfertaFormateado()?20:21),r(7),v("value",n.mesesSeleccionados()),r(),w(n.opcionesCuotas),r(7),g(" ",n.cuotaMensual()," "),r(6),s(n.producto().descripcion?41:-1),r(6),v("disabled",n.cantidad()<=1),r(3),v("value",n.cantidad())("min",1)("max",n.producto().stock),r(),v("disabled",n.cantidad()>=n.producto().stock),r(3),s(n.producto().stock>0?54:-1),r(2),v("disabled",n.producto().stock===0||n.agregandoCarrito()),r(),s(n.agregandoCarrito()?57:58),r(2),s(n.producto().stock>0?59:-1),r(10),s(n.producto().garantia?69:-1)}},dependencies:[M,oe,Te,Ie],styles:["button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px #00000026}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})};var me=(i,t)=>t.id,st=()=>[1,2,3,4];function mt(i,t){i&1&&p(0,"div",5)}function pt(i,t){i&1&&(o(0,"div",1),p(1,"div",3),o(2,"div",4),S(3,mt,1,0,"div",5,R),a()()),i&2&&(r(3),w(G(0,st)))}function ut(i,t){if(i&1){let e=h();o(0,"div",2)(1,"p",6),c(2),a(),o(3,"button",7),f("click",function(){b(e);let l=d(2);return C(l.recargarVariaciones())}),c(4," Reintentar "),a()()}if(i&2){let e=d(2);r(2),I(e.errorVariaciones())}}function _t(i,t){if(i&1&&(o(0,"span",11),c(1),a()),i&2){let e,n=d().$implicit,l=d(3);r(),g(" ",(e=l.obtenerValorSeleccionado(n.id))==null?null:e.valor," ")}}function gt(i,t){i&1&&(o(0,"div",17),x(),o(1,"svg",19),p(2,"path",20),a()())}function ft(i,t){i&1&&p(0,"div",18)}function xt(i,t){if(i&1){let e=h();o(0,"button",15),f("click",function(){let l=b(e).$implicit,m=d(2).$implicit,E=d(3);return C(E.seleccionarValor(m.id,l))}),p(1,"div",16),u(2,gt,3,0,"div",17)(3,ft,1,0,"div",18),a()}if(i&2){let e=t.$implicit,n=d(2).$implicit,l=d(3);T("border-blue-500",l.esValorSeleccionado(n.id,e.id))("border-gray-300",!l.esValorSeleccionado(n.id,e.id))("shadow-md",l.esValorSeleccionado(n.id,e.id)),v("disabled",!e.disponible)("title",e.valor),r(),X("background-color",e.codigo_color||"#000000"),T("opacity-50",!e.disponible),r(),s(l.esValorSeleccionado(n.id,e.id)?2:-1),r(),s(e.disponible?-1:3)}}function vt(i,t){if(i&1&&(o(0,"div",12),S(1,xt,4,14,"button",14,me),a()),i&2){let e=d().$implicit;r(),w(e.valores)}}function bt(i,t){i&1&&c(0," (Sin stock) ")}function Ct(i,t){if(i&1&&(o(0,"option",23),c(1),u(2,bt,1,0),a()),i&2){let e=t.$implicit;v("value",e.id)("disabled",!e.disponible),r(),g(" ",e.valor," "),r(),s(e.disponible?-1:2)}}function ht(i,t){if(i&1&&(o(0,"p",24),c(1),a()),i&2){let e=d(2).$implicit,n=d(3);r(),g(" ",n.obtenerStockDisponible(e.id)," disponibles ")}}function yt(i,t){if(i&1){let e=h();o(0,"div",13)(1,"select",21),f("change",function(l){b(e);let m=d().$implicit,E=d(3);return C(E.onSelectChange(l,m.id,m.valores))}),o(2,"option",22),c(3),a(),S(4,Ct,3,4,"option",23,me),a(),u(6,ht,2,1,"p",24),a()}if(i&2){let e,n=d().$implicit,l=d(3);r(),v("value",((e=l.obtenerValorSeleccionado(n.id))==null?null:e.id)||""),r(2),g(" Seleccionar ",n.nombre," "),r(),w(n.valores),r(2),s(l.obtenerValorSeleccionado(n.id)&&l.obtenerStockDisponible(n.id)?6:-1)}}function St(i,t){if(i&1&&(o(0,"div")(1,"div",9)(2,"span",10),c(3),a(),u(4,_t,2,1,"span",11),a(),u(5,vt,3,0,"div",12)(6,yt,7,3,"div",13),a()),i&2){let e=t.$implicit,n=d(3);r(3),g(" ",e.nombre,": "),r(),s(n.obtenerValorSeleccionado(e.id)?4:-1),r(),s(e.tipo==="color"?5:6)}}function wt(i,t){if(i&1&&(o(0,"div",28)(1,"span",29),c(2),a(),o(3,"span",30),c(4),a(),o(5,"span",31),c(6),a()()),i&2){let e=d(4);r(2),g(" ",e.formatearPrecio(e.variacionActual().precio)," "),r(2),g(" ",e.formatearPrecio(e.variacionActual().precio_oferta)," "),r(2),g(" -",e.calcularPorcentajeDescuento(),"% ")}}function Pt(i,t){if(i&1&&(o(0,"div",8)(1,"h4",25),c(2," Variaci\xF3n Seleccionada "),a(),o(3,"div",26)(4,"div")(5,"span"),c(6,"SKU:"),a(),o(7,"span",27),c(8),a()(),o(9,"div")(10,"span"),c(11,"Stock:"),a(),o(12,"span",27),c(13),a()()(),u(14,wt,7,3,"div",28),a()),i&2){let e=d(3);r(8),I(e.variacionActual().sku),r(5),I(e.variacionActual().stock),r(),s(e.variacionActual().precio_oferta?14:-1)}}function Et(i,t){if(i&1&&(o(0,"div",0),S(1,St,7,3,"div",null,me),a(),u(3,Pt,15,3,"div",8)),i&2){let e=d(2);r(),w(e.atributosDisponibles()),r(2),s(e.variacionActual()&&e.esSeleccionValida()?3:-1)}}function kt(i,t){if(i&1&&(o(0,"div",0),u(1,pt,5,1,"div",1)(2,ut,5,1,"div",2)(3,Et,4,1),a()),i&2){let e=d();r(),s(e.cargandoVariaciones()?1:e.errorVariaciones()?2:3)}}var le=class i{destroyRef=P(z);producto=V.required();variacionCambiada=B();_cargandoVariaciones=y(!1);_errorVariaciones=y(null);_atributosDisponibles=y([]);_variacionesDisponibles=y([]);_seleccionesActuales=y({});cargandoVariaciones=_(()=>this._cargandoVariaciones());errorVariaciones=_(()=>this._errorVariaciones());atributosDisponibles=_(()=>this._atributosDisponibles());variacionesDisponibles=_(()=>this._variacionesDisponibles());tieneVariaciones=_(()=>{let t=this.producto();return t.variaciones_count!==void 0&&t.variaciones_count>0});variacionActual=_(()=>{let t=this._seleccionesActuales(),e=this.variacionesDisponibles();return Object.keys(t).length===0?null:e.find(n=>Object.entries(t).every(([l,m])=>{let E=this._atributosDisponibles().find(L=>L.id===parseInt(l));return E?n.atributos[E.nombre.toLowerCase()]===m.valor.toLowerCase():!1}))||null});esSeleccionValida=_(()=>{let t=this._atributosDisponibles(),e=this._seleccionesActuales();return t.length>0&&Object.keys(e).length===t.length});ngOnInit(){this.tieneVariaciones()&&this.cargarVariaciones()}cargarVariaciones(){this._cargandoVariaciones.set(!0),this._errorVariaciones.set(null),setTimeout(()=>{try{let t=[{id:1,nombre:"Color",tipo:"color",valores:[{id:1,valor:"Negro",codigo_color:"#000000",disponible:!0,stock:10},{id:2,valor:"Amarillo",codigo_color:"#FFC107",disponible:!0,stock:5},{id:3,valor:"Azul",codigo_color:"#2196F3",disponible:!1,stock:0}]},{id:2,nombre:"Pantalla",tipo:"tama\xF1o",valores:[{id:4,valor:'6.1"',disponible:!0,stock:10},{id:5,valor:'6.7"',disponible:!0,stock:3}]}],e=[{id:1,sku:"IPHONE11-NEGRO-61",precio:2299,precio_oferta:2199,stock:10,atributos:{color:"negro",pantalla:'6.1"'}},{id:2,sku:"IPHONE11-AMARILLO-61",precio:2299,stock:5,atributos:{color:"amarillo",pantalla:'6.1"'}}];this._atributosDisponibles.set(t),this._variacionesDisponibles.set(e)}catch(t){this._errorVariaciones.set("Error al cargar variaciones"),console.error("Error cargando variaciones:",t)}finally{this._cargandoVariaciones.set(!1)}},800)}recargarVariaciones(){this.cargarVariaciones()}seleccionarValor(t,e){e.disponible&&(this._seleccionesActuales.update(n=>O(D({},n),{[t]:e})),this.emitirCambioVariacion())}onSelectChange(t,e,n){let l=parseInt(t.target.value),m=n.find(E=>E.id===l);m&&this.seleccionarValor(e,m)}esValorSeleccionado(t,e){return this._seleccionesActuales()[t]?.id===e}obtenerValorSeleccionado(t){return this._seleccionesActuales()[t]||null}obtenerStockDisponible(t){return this.obtenerValorSeleccionado(t)?.stock||0}calcularPorcentajeDescuento(){let t=this.variacionActual();return t&&t.precio_oferta?Math.round((t.precio-t.precio_oferta)/t.precio*100):0}formatearPrecio(t){return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}emitirCambioVariacion(){let t=this.variacionActual(),e=this.esSeleccionValida(),n={variacionSeleccionada:t,precioActualizado:t?.precio_oferta||t?.precio||this.producto().precio,stockActualizado:t?.stock||this.producto().stock,imagenActualizada:null,esValida:e};console.log("\u{1F504} [VARIACIONES] Emitiendo cambio:",n),this.variacionCambiada.emit(n)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-variaciones-producto"]],inputs:{producto:[1,"producto"]},outputs:{variacionCambiada:"variacionCambiada"},standalone:!0,features:[A],decls:1,vars:1,consts:[[1,"space-y-6"],[1,"space-y-4"],[1,"text-center","py-4"],[1,"h-4","bg-gray-200","rounded","animate-pulse","w-1/3"],[1,"grid","grid-cols-4","gap-2"],[1,"h-10","bg-gray-200","rounded","animate-pulse"],[1,"text-red-600","text-sm"],["type","button",1,"mt-2","text-blue-600","hover:text-blue-700","text-sm","underline",3,"click"],[1,"bg-gray-50","rounded-lg","p-4","space-y-2","border","border-gray-200"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"flex","flex-wrap","gap-2"],[1,"relative"],["type","button",1,"group","relative","w-8","h-8","rounded-full","border-2","transition-all","duration-200","hover:scale-110",3,"border-blue-500","border-gray-300","shadow-md","disabled","title"],["type","button",1,"group","relative","w-8","h-8","rounded-full","border-2","transition-all","duration-200","hover:scale-110",3,"click","disabled","title"],[1,"w-full","h-full","rounded-full"],[1,"absolute","inset-0","flex","items-center","justify-center"],[1,"absolute","-top-1","-right-1","w-3","h-3","bg-red-500","rounded-full","border","border-white"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3","h-3","text-white","drop-shadow-sm"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","text-sm","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"change","value"],["value","","disabled",""],[3,"value","disabled"],[1,"mt-1","text-xs","text-green-600"],[1,"font-medium","text-gray-900","text-sm"],[1,"grid","grid-cols-2","gap-4","text-xs","text-gray-600"],[1,"ml-1","font-medium","text-gray-900"],[1,"flex","items-center","space-x-2"],[1,"text-xs","text-gray-500","line-through"],[1,"text-sm","font-bold","text-red-600"],[1,"text-xs","bg-red-100","text-red-800","px-2","py-1","rounded-full"]],template:function(e,n){e&1&&u(0,kt,4,1,"div",0),e&2&&s(n.tieneVariaciones()?0:-1)},dependencies:[M],encapsulation:2})};var Tt=(i,t)=>t.id,pe=()=>[1,2,3,4,5],It=()=>[5,4,3,2,1];function Vt(i,t){if(i&1&&(x(),o(0,"svg",15),p(1,"path",16),a()),i&2){let e=t.$implicit,n=d();T("text-yellow-400",e<=n.Math.round(n.estadisticas().promedio))("text-gray-300",e>n.Math.round(n.estadisticas().promedio))}}function Ft(i,t){if(i&1&&(o(0,"div",9)(1,"span",17),c(2),a(),x(),o(3,"svg",18),p(4,"path",16),a(),k(),o(5,"div",19),p(6,"div",20),a(),o(7,"span",21),c(8),a()()),i&2){let e=t.$implicit,n=d();r(2),I(e),r(4),X("width",n.porcentajeEstrella(e),"%"),r(2),g(" ",n.estadisticas().distribucion[e]||0," ")}}function At(i,t){if(i&1){let e=h();o(0,"button",35),f("click",function(){let l=b(e).$implicit,m=d(2);return C(m.seleccionarCalificacion(l))}),x(),o(1,"svg",36),p(2,"path",16),a()()}if(i&2){let e=t.$implicit,n=d(2);r(),T("text-yellow-400",e<=n.calificacionSeleccionada())("text-gray-300",e>n.calificacionSeleccionada())("hover:text-yellow-300",e>n.calificacionSeleccionada())}}function Mt(i,t){i&1&&(o(0,"p",27),c(1," Por favor selecciona una calificaci\xF3n. "),a())}function Rt(i,t){i&1&&(o(0,"p",27),c(1," Por favor escribe tu rese\xF1a (m\xEDnimo 10 caracteres). "),a())}function Dt(i,t){i&1&&(o(0,"p",27),c(1," Por favor ingresa tu nombre. "),a())}function Ot(i,t){i&1&&c(0," Enviando... ")}function Gt(i,t){i&1&&c(0," Enviar Rese\xF1a ")}function jt(i,t){if(i&1){let e=h();o(0,"div",11)(1,"h4",22),c(2," Escribe tu rese\xF1a "),a(),o(3,"form",23),f("ngSubmit",function(){b(e);let l=d();return C(l.enviarResena())}),o(4,"div")(5,"label",24),c(6," Calificaci\xF3n "),a(),o(7,"div",25),S(8,At,3,6,"button",26,R),a(),u(10,Mt,2,0,"p",27),a(),o(11,"div")(12,"label",28),c(13," Tu rese\xF1a "),a(),p(14,"textarea",29),u(15,Rt,2,0,"p",27),a(),o(16,"div")(17,"label",30),c(18," Tu nombre "),a(),p(19,"input",31),u(20,Dt,2,0,"p",27),a(),o(21,"div",32)(22,"button",33),u(23,Ot,1,0)(24,Gt,1,0),a(),o(25,"button",34),f("click",function(){b(e);let l=d();return C(l.cancelarResena())}),c(26," Cancelar "),a()()()()}if(i&2){let e,n,l,m=d();r(3),v("formGroup",m.formResena),r(5),w(G(6,pe)),r(2),s((e=m.formResena.get("calificacion"))!=null&&e.touched&&((e=m.formResena.get("calificacion"))!=null&&e.invalid)?10:-1),r(5),s((n=m.formResena.get("comentario"))!=null&&n.touched&&((n=m.formResena.get("comentario"))!=null&&n.invalid)?15:-1),r(5),s((l=m.formResena.get("usuario"))!=null&&l.touched&&((l=m.formResena.get("usuario"))!=null&&l.invalid)?20:-1),r(2),v("disabled",m.formResena.invalid||m.enviandoResena()),r(),s(m.enviandoResena()?23:24)}}function $t(i,t){i&1&&(o(0,"div",14),x(),o(1,"svg",37),p(2,"path",38),a(),k(),o(3,"p",39),c(4,"A\xFAn no hay rese\xF1as para este producto."),a(),o(5,"p",40),c(6," \xA1S\xE9 el primero en compartir tu experiencia! "),a()())}function Nt(i,t){if(i&1&&(x(),o(0,"svg",49),p(1,"path",16),a()),i&2){let e=t.$implicit,n=d().$implicit;T("text-yellow-400",e<=n.calificacion)("text-gray-300",e>n.calificacion)}}function Lt(i,t){if(i&1&&(o(0,"div",11)(1,"div",42)(2,"div")(3,"div",43)(4,"div",44),S(5,Nt,2,4,":svg:svg",45,R),a(),o(7,"span",46),c(8," Usuario An\xF3nimo "),a()(),o(9,"p",47),c(10),a()()(),o(11,"p",48),c(12),a()()),i&2){let e=t.$implicit,n=d(2);r(5),w(G(2,pe)),r(5),g(" ",n.formatearFecha(e.created_at)," "),r(2),g(" ",e.comentario," ")}}function zt(i,t){if(i&1){let e=h();o(0,"button",52),f("click",function(){let l=b(e).$implicit,m=d(3);return C(m.cambiarPagina(l))}),c(1),a()}if(i&2){let e=t.$implicit,n=d(3);T("bg-blue-600",e===n.paginaActual())("text-white",e===n.paginaActual())("bg-white",e!==n.paginaActual())("text-gray-900",e!==n.paginaActual())("border",e!==n.paginaActual())("border-gray-300",e!==n.paginaActual())("hover:bg-gray-50",e!==n.paginaActual()),r(),g(" ",e," ")}}function Bt(i,t){if(i&1){let e=h();o(0,"div",41)(1,"nav",9)(2,"button",50),f("click",function(){b(e);let l=d(2);return C(l.cambiarPagina(l.paginaActual()-1))}),c(3," Anterior "),a(),S(4,zt,2,15,"button",51,R),o(6,"button",50),f("click",function(){b(e);let l=d(2);return C(l.cambiarPagina(l.paginaActual()+1))}),c(7," Siguiente "),a()()()}if(i&2){let e=d(2);r(2),v("disabled",e.paginaActual()===1),r(2),w(e.paginasVisibles()),r(2),v("disabled",e.paginaActual()===e.totalPaginas())}}function Ht(i,t){if(i&1&&(o(0,"div",12),S(1,Lt,13,3,"div",11,Tt),a(),u(3,Bt,8,2,"div",41)),i&2){let e=d();r(),w(e.resenasPaginadas()),r(2),s(e.totalPaginas()>1?3:-1)}}var ce=class i{platformId=P($);fb=P(Ve);producto=V.required();_mostrarFormulario=y(!1);_calificacionSeleccionada=y(0);_enviandoResena=y(!1);_paginaActual=y(1);_resenasSimuladas=y([]);RESENAS_POR_PAGINA=5;formResena;mostrarFormulario=_(()=>this._mostrarFormulario());calificacionSeleccionada=_(()=>this._calificacionSeleccionada());enviandoResena=_(()=>this._enviandoResena());paginaActual=_(()=>this._paginaActual());resenas=_(()=>{let t=this.producto().comentarios||[],e=this._resenasSimuladas();return[...t,...e].sort((n,l)=>new Date(l.created_at).getTime()-new Date(n.created_at).getTime())});estadisticas=_(()=>{let t=this.resenas(),e=t.length;if(e===0)return{promedio:0,total:0,distribucion:{1:0,2:0,3:0,4:0,5:0}};let l=t.reduce((E,L)=>E+L.calificacion,0)/e,m=t.reduce((E,L)=>(E[L.calificacion]=(E[L.calificacion]||0)+1,E),{});for(let E=1;E<=5;E++)m[E]||(m[E]=0);return{promedio:l,total:e,distribucion:m}});totalPaginas=_(()=>Math.ceil(this.resenas().length/this.RESENAS_POR_PAGINA));resenasPaginadas=_(()=>{let t=this.resenas(),e=(this.paginaActual()-1)*this.RESENAS_POR_PAGINA;return t.slice(e,e+this.RESENAS_POR_PAGINA)});paginasVisibles=_(()=>{let t=this.totalPaginas(),e=this.paginaActual(),n=[];for(let l=Math.max(1,e-2);l<=Math.min(t,e+2);l++)n.push(l);return n});constructor(){this.formResena=this.fb.group({calificacion:[0,[N.required,N.min(1)]],comentario:["",[N.required,N.minLength(10)]],usuario:["",[N.required,N.minLength(2)]]})}porcentajeEstrella(t){let e=this.estadisticas().total;return e===0?0:(this.estadisticas().distribucion[t]||0)/e*100}toggleFormularioResena(){this._mostrarFormulario.update(t=>!t),this.mostrarFormulario()||this.limpiarFormulario()}seleccionarCalificacion(t){this._calificacionSeleccionada.set(t),this.formResena.patchValue({calificacion:t})}enviarResena(){this.formResena.invalid||(this._enviandoResena.set(!0),setTimeout(()=>{let t={id:Date.now(),producto_id:this.producto().id,usuario_id:1,calificacion:this.formResena.value.calificacion,comentario:this.formResena.value.comentario,activo:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};this._resenasSimuladas.update(e=>[t,...e]),this._enviandoResena.set(!1),this._mostrarFormulario.set(!1),this.limpiarFormulario(),j(this.platformId)&&console.log("Rese\xF1a agregada:",t)},1e3))}cancelarResena(){this._mostrarFormulario.set(!1),this.limpiarFormulario()}limpiarFormulario(){this.formResena.reset(),this._calificacionSeleccionada.set(0)}cambiarPagina(t){t>=1&&t<=this.totalPaginas()&&this._paginaActual.set(t)}formatearFecha(t){return new Date(t).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"})}Math=Math;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-resenas-producto"]],inputs:{producto:[1,"producto"]},standalone:!0,features:[A],decls:23,vars:8,consts:[[1,"space-y-6"],[1,"bg-gray-50","rounded-lg","p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"text-center"],[1,"text-4xl","font-bold","text-gray-900","mb-2"],[1,"flex","justify-center","mb-2"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6",3,"text-yellow-400","text-gray-300"],[1,"text-gray-600"],[1,"space-y-2"],[1,"flex","items-center","gap-2"],["type","button",1,"bg-blue-600","hover:bg-blue-700","text-white","font-medium","py-2","px-6","rounded-lg","transition-colors","duration-200",3,"click"],[1,"bg-white","border","border-gray-200","rounded-lg","p-6"],[1,"space-y-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-center","py-8"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6"],["d","M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"],[1,"text-sm","text-gray-600","w-8"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-yellow-400"],[1,"flex-1","bg-gray-200","rounded-full","h-2"],[1,"bg-yellow-400","h-2","rounded-full","transition-all","duration-300"],[1,"text-sm","text-gray-600","w-8","text-right"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"flex","gap-1"],["type","button",1,"p-1","transition-colors","duration-200"],[1,"mt-1","text-sm","text-red-600"],["for","comentario",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","comentario","formControlName","comentario","rows","4","placeholder","Comparte tu experiencia con este producto...",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["for","usuario",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","usuario","type","text","formControlName","usuario","placeholder","Tu nombre",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"flex","gap-3","pt-4"],["type","submit",1,"bg-blue-600","hover:bg-blue-700","text-white","font-medium","py-2","px-6","rounded-lg","transition-colors","duration-200","disabled:bg-gray-300","disabled:cursor-not-allowed",3,"disabled"],["type","button",1,"bg-gray-200","hover:bg-gray-300","text-gray-700","font-medium","py-2","px-6","rounded-lg","transition-colors","duration-200",3,"click"],["type","button",1,"p-1","transition-colors","duration-200",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-8","h-8"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-300","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"],[1,"text-gray-500"],[1,"text-gray-400","text-sm"],[1,"flex","justify-center","mt-6"],[1,"flex","items-start","justify-between","mb-3"],[1,"flex","items-center","gap-2","mb-1"],[1,"flex"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4",3,"text-yellow-400","text-gray-300"],[1,"font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"text-gray-700","leading-relaxed"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4"],["type","button",1,"px-3","py-2","text-sm","font-medium","text-gray-500","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","button",1,"px-3","py-2","text-sm","font-medium","rounded-lg","transition-colors","duration-200",3,"bg-blue-600","text-white","bg-white","text-gray-900","border","border-gray-300","hover:bg-gray-50"],["type","button",1,"px-3","py-2","text-sm","font-medium","rounded-lg","transition-colors","duration-200",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),c(5),a(),o(6,"div",5),S(7,Vt,2,4,":svg:svg",6,R),a(),o(9,"p",7),c(10),a()(),o(11,"div",8),S(12,Ft,9,4,"div",9,R),a()()(),o(14,"div",3)(15,"button",10),f("click",function(){return n.toggleFormularioResena()}),c(16),a()(),u(17,jt,27,7,"div",11),o(18,"div",12)(19,"h4",13),c(20,"Rese\xF1as de Clientes"),a(),u(21,$t,7,0,"div",14)(22,Ht,4,1),a()()),e&2&&(r(5),g(" ",n.estadisticas().promedio.toFixed(1)," "),r(2),w(G(6,pe)),r(3),ge(" Basado en ",n.estadisticas().total," ",n.estadisticas().total===1?"rese\xF1a":"rese\xF1as"," "),r(2),w(G(7,It)),r(4),g(" ",n.mostrarFormulario()?"Cancelar":"Escribir Rese\xF1a"," "),r(),s(n.mostrarFormulario()?17:-1),r(4),s(n.resenas().length===0?21:22))},dependencies:[M,oe,Pe,ye,Se,we,Fe,Ee,ke],styles:["form[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .3s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}svg[_ngcontent-%COMP%]{transition:color .2s ease-in-out}button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{transform:scale(1.1)}"]})};var qt=(i,t)=>t.id;function Ut(i,t){if(i&1){let e=h();o(0,"button",8),f("click",function(){let l=b(e).$implicit,m=d();return C(m.seleccionarTab(l.id))}),o(1,"div",9),x(),p(2,"svg",10),k(),o(3,"span",11),c(4),a()(),p(5,"span",12),a()}if(i&2){let e=t.$implicit,n=d();T("text-blue-600",n.tabActivo()===e.id)("border-blue-500",n.tabActivo()===e.id)("text-gray-500",n.tabActivo()!==e.id)("border-transparent",n.tabActivo()!==e.id)("hover:text-gray-700",n.tabActivo()!==e.id),Z("aria-current",n.tabActivo()===e.id?"page":null),r(2),v("innerHTML",e.icono,ue),r(2),I(e.label),r(),T("bg-blue-500",n.tabActivo()===e.id)("bg-transparent",n.tabActivo()!==e.id)}}function Zt(i,t){if(i&1&&(o(0,"div",14)(1,"p",17),c(2),a()()),i&2){let e=d(2);r(2),g(" ",e.producto().descripcion," ")}}function Wt(i,t){i&1&&(o(0,"p",15),c(1," No hay descripci\xF3n disponible para este producto. "),a())}function Yt(i,t){if(i&1&&(o(0,"li",20),x(),o(1,"svg",21),p(2,"path",22),a(),k(),o(3,"span",23),c(4),a()()),i&2){let e=t.$implicit;r(4),I(e)}}function Kt(i,t){if(i&1&&(o(0,"div",16)(1,"h4",18),c(2," Caracter\xEDsticas Principales: "),a(),o(3,"ul",19),S(4,Yt,5,1,"li",20,_e),a()()),i&2){let e=d(2);r(4),w(e.producto().caracteristicas)}}function Jt(i,t){if(i&1&&(o(0,"div",5)(1,"h3",13),c(2," Descripci\xF3n del Producto "),a(),u(3,Zt,3,1,"div",14)(4,Wt,2,0,"p",15)(5,Kt,6,0,"div",16),a()),i&2){let e,n=d();r(3),s(n.producto().descripcion?3:4),r(2),s(n.producto().caracteristicas&&((e=(e=n.producto().caracteristicas)==null?null:e.length)!==null&&e!==void 0?e:0)>0?5:-1)}}function Qt(i,t){if(i&1&&(o(0,"div",26)(1,"dt",27),c(2,"Marca"),a(),o(3,"dd",28),c(4),a()()),i&2){let e=d(2);r(4),g(" ",e.producto().marca," ")}}function Xt(i,t){if(i&1&&(o(0,"div",26)(1,"dt",27),c(2,"Categor\xEDa"),a(),o(3,"dd",28),c(4),a()()),i&2){let e,n=d(2);r(4),g(" ",(e=n.producto().categoria)==null?null:e.nombre," ")}}function ei(i,t){if(i&1&&(o(0,"span",29),c(1),a()),i&2){let e=d(2);r(),g(" En Stock (",e.producto().stock," unidades) ")}}function ti(i,t){i&1&&(o(0,"span",30),c(1," Sin Stock "),a())}function ii(i,t){if(i&1&&(o(0,"div",26)(1,"dt",27),c(2,"Peso"),a(),o(3,"dd",28),c(4),a()()),i&2){let e=d(2);r(4),g(" ",e.producto().peso," kg ")}}function ni(i,t){if(i&1&&(o(0,"div",26)(1,"dt",27),c(2,"Dimensiones"),a(),o(3,"dd",28),c(4),a()()),i&2){let e=d(2);r(4),g(" ",e.producto().dimensiones," ")}}function oi(i,t){if(i&1&&(o(0,"div",26)(1,"dt",27),c(2,"Garant\xEDa"),a(),o(3,"dd",28),c(4),a()()),i&2){let e=d(2);r(4),g(" ",e.producto().garantia," ")}}function ai(i,t){if(i&1&&(o(0,"div",6)(1,"h3",13),c(2," Especificaciones T\xE9cnicas "),a(),o(3,"div",24)(4,"dl",25)(5,"div",26)(6,"dt",27),c(7,"SKU"),a(),o(8,"dd",28),c(9),a()(),u(10,Qt,5,1,"div",26)(11,Xt,5,1,"div",26),o(12,"div",26)(13,"dt",27),c(14,"Estado"),a(),o(15,"dd",28),u(16,ei,2,1,"span",29)(17,ti,2,0,"span",30),a()(),u(18,ii,5,1,"div",26)(19,ni,5,1,"div",26)(20,oi,5,1,"div",26),a()()()),i&2){let e,n,l,m=d();r(9),g(" ",m.producto().sku," "),r(),s(m.producto().marca?10:-1),r(),s((e=m.producto().categoria)!=null&&e.nombre?11:-1),r(5),s(m.producto().stock>0?16:17),r(2),s(m.producto().peso!=null&&((n=m.producto().peso)!==null&&n!==void 0?n:0)>0?18:-1),r(),s(m.producto().dimensiones!=null&&((l=(l=m.producto().dimensiones)==null?null:l.length)!==null&&l!==void 0?l:0)>0?19:-1),r(),s(m.producto().garantia?20:-1)}}function ri(i,t){if(i&1&&(o(0,"div",7),p(1,"app-resenas-producto",31),a()),i&2){let e=d();r(),v("producto",e.producto())}}var de=class i{producto=V.required();_tabActivo=y("descripcion");tabActivo=_(()=>this._tabActivo());tabs=_(()=>[{id:"descripcion",label:"Descripci\xF3n",icono:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />',activo:this._tabActivo()==="descripcion"},{id:"especificaciones",label:"Especificaciones",icono:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />',activo:this._tabActivo()==="especificaciones"},{id:"resenas",label:"Rese\xF1as",icono:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />',activo:this._tabActivo()==="resenas"}]);seleccionarTab(t){this._tabActivo.set(t)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-tabs-informacion"]],inputs:{producto:[1,"producto"]},standalone:!0,features:[A],decls:9,vars:3,consts:[[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-8","px-6"],["type","button",1,"group","relative","min-w-0","flex-1","overflow-hidden","py-4","px-1","text-center","text-sm","font-medium","transition-colors","duration-200","focus:z-10",3,"text-blue-600","border-blue-500","text-gray-500","border-transparent","hover:text-gray-700"],[1,"p-6"],["role","tabpanel","aria-labelledby","descripcion-tab",1,"space-y-4"],["role","tabpanel","aria-labelledby","especificaciones-tab",1,"space-y-4"],["role","tabpanel","aria-labelledby","resenas-tab"],["type","button",1,"group","relative","min-w-0","flex-1","overflow-hidden","py-4","px-1","text-center","text-sm","font-medium","transition-colors","duration-200","focus:z-10",3,"click"],[1,"flex","items-center","justify-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5",3,"innerHTML"],[1,"hidden","sm:block"],["aria-hidden","true",1,"absolute","inset-x-0","bottom-0","h-0.5","transition-colors","duration-200"],[1,"text-lg","font-semibold","text-gray-900"],[1,"prose","prose-gray","max-w-none"],[1,"text-gray-500","italic"],[1,"mt-6"],[1,"text-gray-700","leading-relaxed","whitespace-pre-line"],[1,"font-medium","text-gray-900","mb-3"],[1,"space-y-2"],[1,"flex","items-start","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-green-500","mt-0.5","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"text-gray-700"],[1,"overflow-hidden"],[1,"divide-y","divide-gray-200"],[1,"py-3","sm:grid","sm:grid-cols-3","sm:gap-4"],[1,"text-sm","font-medium","text-gray-500"],[1,"mt-1","text-sm","text-gray-900","sm:mt-0","sm:col-span-2"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-red-100","text-red-800"],[3,"producto"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"nav",2),S(3,Ut,6,17,"button",3,qt),a()(),o(5,"div",4),u(6,Jt,6,2,"div",5)(7,ai,21,7,"div",6)(8,ri,2,1,"div",7),a()()),e&2&&(r(3),w(n.tabs()),r(3),s(n.tabActivo()==="descripcion"?6:-1),r(),s(n.tabActivo()==="especificaciones"?7:-1),r(),s(n.tabActivo()==="resenas"?8:-1))},dependencies:[M,ce],styles:["[role=tabpanel][_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{color:inherit}@media (max-width: 640px){nav[_ngcontent-%COMP%]{overflow-x:auto;scrollbar-width:none;-ms-overflow-style:none}nav[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}}"]})};var li=(i,t)=>t.id,ci=()=>[1,2,3,4],di=()=>[1,2,3,4,5];function si(i,t){i&1&&(o(0,"div",5),p(1,"div",6),o(2,"div",7),p(3,"div",8)(4,"div",9)(5,"div",10),a()())}function mi(i,t){i&1&&(o(0,"div",3),S(1,si,6,0,"div",5,R),a()),i&2&&(r(),w(G(0,ci)))}function pi(i,t){i&1&&(o(0,"div",4),x(),o(1,"svg",11),p(2,"path",12),a(),k(),o(3,"p",13),c(4," No se pudieron cargar los productos relacionados. "),a()())}function ui(i,t){i&1&&(o(0,"div",4),x(),o(1,"svg",11),p(2,"path",14),a(),k(),o(3,"p",13),c(4," No hay productos relacionados disponibles. "),a()())}function _i(i,t){if(i&1&&p(0,"img",19),i&2){let e=d().$implicit,n=d(2);v("ngSrc",n.getImagenUrl(e.imagen_principal))("alt",e.nombre)("width",300)("height",300)}}function gi(i,t){i&1&&(o(0,"div",20),x(),o(1,"svg",28),p(2,"path",29),a()())}function fi(i,t){if(i&1&&(o(0,"div",21)(1,"span",30),c(2),a()()),i&2){let e=d().$implicit,n=d(2);r(2),g(" ",n.calcularDescuento(e),"% OFF ")}}function xi(i,t){i&1&&(o(0,"div",22)(1,"span",31),c(2," Sin Stock "),a()())}function vi(i,t){if(i&1&&(o(0,"p",23),c(1),a()),i&2){let e=d().$implicit;r(),g(" ",e.marca," ")}}function bi(i,t){if(i&1&&(o(0,"div",32)(1,"span",33),c(2),a()(),o(3,"span",34),c(4),a()),i&2){let e=d().$implicit,n=d(2);r(2),g(" ",n.formatearPrecio(e.precio_oferta)," "),r(2),g(" ",n.formatearPrecio(e.precio)," ")}}function Ci(i,t){if(i&1&&(o(0,"span",26),c(1),a()),i&2){let e=d().$implicit,n=d(2);r(),g(" ",n.formatearPrecio(e.precio)," ")}}function hi(i,t){if(i&1&&(x(),o(0,"svg",38),p(1,"path",39),a()),i&2){let e=t.$implicit,n=d(2).$implicit,l=d(2);T("text-yellow-400",e<=l.Math.round(n.rating_promedio))("text-gray-300",e>l.Math.round(n.rating_promedio))}}function yi(i,t){if(i&1&&(o(0,"div",27)(1,"div",35),S(2,hi,2,4,":svg:svg",36,R),a(),o(4,"span",37),c(5),a()()),i&2){let e=d().$implicit;r(2),w(G(1,di)),r(3),g(" (",e.total_comentarios||0,") ")}}function Si(i,t){if(i&1){let e=h();o(0,"div",17),f("click",function(){let l=b(e).$implicit,m=d(2);return C(m.navegarAProducto(l))}),o(1,"div",18),u(2,_i,1,4,"img",19)(3,gi,3,0,"div",20)(4,fi,3,1,"div",21)(5,xi,3,0,"div",22),a(),o(6,"div",7),u(7,vi,2,1,"p",23),o(8,"h4",24),c(9),a(),o(10,"div",25),u(11,bi,5,2)(12,Ci,2,1,"span",26),a(),u(13,yi,6,2,"div",27),a()()}if(i&2){let e=t.$implicit;r(2),s(e.imagen_principal?2:3),r(2),s(e.precio_oferta?4:-1),r(),s(e.stock===0?5:-1),r(2),s(e.marca?7:-1),r(2),g(" ",e.nombre," "),r(2),s(e.precio_oferta?11:12),r(2),s(e.rating_promedio?13:-1)}}function wi(i,t){if(i&1){let e=h();o(0,"div",16)(1,"button",40),f("click",function(){b(e);let l=d(2);return C(l.verMasProductos())}),c(2," Ver M\xE1s Productos "),a()()}}function Pi(i,t){if(i&1&&(o(0,"div",3),S(1,Si,14,7,"div",15,li),a(),u(3,wi,3,0,"div",16)),i&2){let e=d();r(),w(e.productosRelacionados()),r(2),s(e.productosRelacionados().length>=4?3:-1)}}var se=class i{router=P(te);productoService=P(ne);destroyRef=P(z);producto=V.required();_cargando=y(!1);_error=y(null);_productosRelacionados=y([]);cargando=_(()=>this._cargando());error=_(()=>this._error());productosRelacionados=_(()=>this._productosRelacionados());ngOnInit(){this.cargarProductosRelacionados()}cargarProductosRelacionados(){let t=this.producto();if(!t.categoria_id){this._error.set("No se puede cargar productos relacionados sin categor\xEDa");return}this._cargando.set(!0),this._error.set(null),this.productoService.getProductos({categoria_id:t.categoria_id,activo:!0,per_page:8}).pipe(U(e=>{let n=e.data.filter(l=>l.id!==t.id).slice(0,4);this._productosRelacionados.set(n)}),K(e=>(console.error("Error al cargar productos relacionados:",e),this._error.set("Error al cargar productos relacionados"),Y(null))),J(()=>{this._cargando.set(!1)}),W(this.destroyRef)).subscribe()}getImagenUrl(t){if(!t)return"";if(t.startsWith("http://")||t.startsWith("https://"))return t;let e=ie.urlDominioApi.replace("/api",""),n=t.startsWith("/")?t:`/${t}`;return`${e}${n}`}formatearPrecio(t){return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}calcularDescuento(t){if(!t.precio_oferta)return 0;let e=(t.precio-t.precio_oferta)/t.precio*100;return Math.round(e)}navegarAProducto(t){this.router.navigate(["/producto",t.slug])}verMasProductos(){let t=this.producto();t.categoria?.slug?this.router.navigate(["/catalogo"],{queryParams:{categoria:t.categoria.slug}}):this.router.navigate(["/catalogo"])}Math=Math;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-productos-relacionados"]],inputs:{producto:[1,"producto"]},standalone:!0,features:[A],decls:8,vars:1,consts:[[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"p-6"],[1,"text-lg","font-semibold","text-gray-900","mb-6"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"text-center","py-8"],[1,"space-y-3"],[1,"aspect-square","bg-gray-200","rounded-lg","animate-pulse"],[1,"space-y-2"],[1,"h-4","bg-gray-200","rounded","animate-pulse"],[1,"h-4","bg-gray-200","rounded","w-3/4","animate-pulse"],[1,"h-5","bg-gray-200","rounded","w-1/2","animate-pulse"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-gray-300","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"group","cursor-pointer","transform","transition-all","duration-200","hover:scale-105"],[1,"text-center","mt-6"],[1,"group","cursor-pointer","transform","transition-all","duration-200","hover:scale-105",3,"click"],[1,"relative","aspect-square","bg-gray-100","rounded-lg","overflow-hidden","mb-3"],["loading","lazy",1,"w-full","h-full","object-contain","p-2","group-hover:scale-110","transition-transform","duration-300",3,"ngSrc","alt","width","height"],[1,"w-full","h-full","flex","items-center","justify-center"],[1,"absolute","top-2","left-2"],[1,"absolute","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center"],[1,"text-xs","text-blue-600","font-medium","uppercase"],[1,"font-medium","text-gray-900","text-sm","leading-tight","line-clamp-2","group-hover:text-blue-600","transition-colors","duration-200"],[1,"space-y-1"],[1,"font-bold","text-gray-900","text-lg"],[1,"flex","items-center","gap-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"bg-red-500","text-white","text-xs","font-bold","px-2","py-1","rounded"],[1,"bg-red-600","text-white","font-medium","px-3","py-1","rounded"],[1,"flex","items-center","gap-2"],[1,"font-bold","text-red-600","text-lg"],[1,"text-sm","text-gray-500","line-through"],[1,"flex"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3","h-3",3,"text-yellow-400","text-gray-300"],[1,"text-xs","text-gray-500"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3","h-3"],["d","M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"],["type","button",1,"bg-gray-100","hover:bg-gray-200","text-gray-700","font-medium","py-2","px-6","rounded-lg","transition-colors","duration-200",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"h3",2),c(3," Productos Relacionados "),a(),u(4,mi,3,1,"div",3)(5,pi,5,0,"div",4)(6,ui,5,0,"div",4)(7,Pi,4,1),a()()),e&2&&(r(4),s(n.cargando()?4:n.error()?5:n.productosRelacionados().length===0?6:7))},dependencies:[M,ee],styles:[".group[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.05)}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}*[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.absolute[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}"]})};var Ei=(i,t)=>t.label,ki=()=>[1,2,3,4],Ti=(i,t)=>({"bg-green-500":i,"bg-red-500":t});function Ii(i,t){if(i&1&&(o(0,"a",10),c(1),a(),x(),o(2,"svg",11),p(3,"path",12),a()),i&2){let e=d().$implicit;v("href",e.url,Q),r(),g(" ",e.label," ")}}function Vi(i,t){if(i&1&&(o(0,"span",9),c(1),a()),i&2){let e=d().$implicit;r(),I(e.label)}}function Fi(i,t){if(i&1&&(o(0,"li",4),u(1,Ii,4,2)(2,Vi,2,1,"span",9),a()),i&2){let e=t.$implicit;r(),s(e.active?2:1)}}function Ai(i,t){i&1&&p(0,"div",14)}function Mi(i,t){i&1&&(o(0,"div",6)(1,"div",13),p(2,"div",14),o(3,"div",15),S(4,Ai,1,0,"div",14,R),a()(),o(6,"div",16)(7,"div",13),p(8,"div",17)(9,"div",18)(10,"div",19),a(),o(11,"div",20),p(12,"div",21)(13,"div",22)(14,"div",23),a(),p(15,"div",24),a()()),i&2&&(r(4),w(G(0,ki)))}function Ri(i,t){if(i&1){let e=h();o(0,"div",7)(1,"div",25)(2,"div",26),x(),o(3,"svg",27),p(4,"path",28),a()(),k(),o(5,"h2",29),c(6),a(),o(7,"p",30),c(8," El producto que buscas no est\xE1 disponible o no existe. "),a(),o(9,"button",31),f("click",function(){b(e);let l=d();return C(l.volverAlCatalogo())}),c(10," Volver al Cat\xE1logo "),a()()()}if(i&2){let e=d();r(6),I(e.error())}}function Di(i,t){if(i&1){let e=h();o(0,"app-variaciones-producto",39),f("variacionCambiada",function(l){b(e);let m=d(2);return C(m.onVariacionCambiada(l))}),a()}if(i&2){let e=d(2);v("producto",e.producto())}}function Oi(i,t){if(i&1){let e=h();o(0,"div",6)(1,"div",32)(2,"app-galeria-imagenes",33),f("imagenCambiada",function(l){b(e);let m=d();return C(m.onImagenSeleccionada(l))}),a()(),o(3,"div",34)(4,"app-informacion-producto",35),f("agregarAlCarrito",function(l){b(e);let m=d();return C(m.onAgregarAlCarrito(l))}),a(),u(5,Di,1,1,"app-variaciones-producto",36),a()(),o(6,"div",37),p(7,"app-tabs-informacion",36),o(8,"div",38),p(9,"app-productos-relacionados",36),a()()}if(i&2){let e=d();r(2),v("imagenes",e.imagenes())("imagenSeleccionada",e.imagenSeleccionada())("producto",e.producto()),r(2),v("producto",e.producto())("precioFormateado",e.precioFormateado())("precioOfertaFormateado",e.precioOfertaFormateado())("porcentajeDescuento",e.porcentajeDescuento()),r(),s(e.tieneVariaciones()?5:-1),r(2),v("producto",e.producto()),r(2),v("producto",e.producto())}}function Gi(i,t){i&1&&(x(),o(0,"svg",41),p(1,"path",42),a())}function ji(i,t){i&1&&(x(),o(0,"svg",41),p(1,"path",43),a())}function $i(i,t){if(i&1&&(o(0,"div",8)(1,"div",40),u(2,Gi,2,0,":svg:svg",41)(3,ji,2,0,":svg:svg",41),o(4,"span"),c(5),a()()()),i&2){let e=d();r(),v("ngClass",fe(3,Ti,e.notificacionCarrito().tipo==="success",e.notificacionCarrito().tipo==="error")),r(),s(e.notificacionCarrito().tipo==="success"?2:3),r(3),I(e.notificacionCarrito().mensaje)}}var Me=class i{route=P(Ce);router=P(te);productoService=P(ne);carritoService=P(he);meta=P(ve);title=P(be);destroyRef=P(z);platformId=P($);_estado=y({cargando:!1,error:null,producto:null,imagenPrincipal:"",imagenSeleccionada:0,variacionSeleccionada:null,precioActual:0,stockActual:0});_notificacionCarrito=y({visible:!1,mensaje:"",tipo:"success"});cargando=_(()=>this._estado().cargando);error=_(()=>this._estado().error);producto=_(()=>this._estado().producto);imagenPrincipal=_(()=>this._estado().imagenPrincipal);imagenSeleccionada=_(()=>this._estado().imagenSeleccionada);variacionSeleccionada=_(()=>this._estado().variacionSeleccionada);precioActual=_(()=>this._estado().precioActual);stockActual=_(()=>this._estado().stockActual);notificacionCarrito=_(()=>this._notificacionCarrito());tituloProducto=_(()=>{let t=this.producto();return t?t.nombre:"Producto no encontrado"});breadcrumbs=_(()=>{let t=this.producto();return t?[{label:"Inicio",url:"/"},{label:"Cat\xE1logo",url:"/catalogo"},{label:t.categoria?.nombre||"Categor\xEDa",url:`/catalogo?categoria=${t.categoria?.slug||""}`},{label:t.nombre,url:"",active:!0}]:[]});precioFormateado=_(()=>{let t=this.precioActual()||this.producto()?.precio||0;return this.formatearPrecio(t)});precioOfertaFormateado=_(()=>{let t=this.variacionSeleccionada(),e=this.producto();return t?.precio_oferta?this.formatearPrecio(t.precio_oferta):e?.precio_oferta&&!t?this.formatearPrecio(e.precio_oferta):null});porcentajeDescuento=_(()=>{let t=this.variacionSeleccionada(),e=this.producto();if(t?.precio_oferta){let n=(t.precio-t.precio_oferta)/t.precio*100;return Math.round(n)}if(e?.precio_oferta&&!t){let n=(e.precio-e.precio_oferta)/e.precio*100;return Math.round(n)}return null});imagenes=_(()=>{let t=this.producto();if(!t)return[];let e=[];return t.imagen_principal&&e.push({url:t.imagen_principal,alt:`${t.nombre} - Imagen principal`,esPrincipal:!0}),e});tieneVariaciones=_(()=>{let t=this.producto();return t&&(t.variaciones_count||0)>0});ngOnInit(){this.cargarProductoPorSlug()}cargarProductoPorSlug(){this.route.paramMap.pipe(U(t=>{let e=t.get("slug");console.log("\u{1F4C4} [PRODUCTO-DETALLE] Slug recibido:",e),e?this.cargarProducto(e):this.manejarError("Slug de producto no v\xE1lido")}),W(this.destroyRef)).subscribe()}cargarProducto(t){this._estado.update(e=>O(D({},e),{cargando:!0,error:null})),this.productoService.getProductos({activo:!0,per_page:100}).pipe(U(e=>{let n=e.data.find(l=>l.slug===t);if(!n){let l=this.extraerIdDeSlug(t);l&&(n=e.data.find(m=>m.id===l))}!n&&!isNaN(Number(t))&&(n=e.data.find(l=>l.id===Number(t))),n?(this.establecerProducto(n),this.configurarSEO(n),console.log(`Producto cargado: ${n.nombre} (${n.slug||n.id})`)):this.manejarError(`Producto con identificador "${t}" no encontrado`)}),K(e=>(console.error("Error al cargar producto:",e),this.manejarError("Error al cargar el producto. Por favor, intenta nuevamente."),Y(null))),J(()=>{this._estado.update(e=>O(D({},e),{cargando:!1}))}),W(this.destroyRef)).subscribe()}extraerIdDeSlug(t){let e=t.match(/-(\d+)$/),n=e?parseInt(e[1],10):null;return console.log("\u{1F50D} [PRODUCTO-DETALLE] ID extra\xEDdo:",n,"del slug:",t),n}establecerProducto(t){this._estado.update(e=>O(D({},e),{producto:t,imagenPrincipal:t.imagen_principal||"",precioActual:t.precio_oferta||t.precio,stockActual:t.stock,error:null}))}configurarSEO(t){this.title.setTitle(t.meta_title||`${t.nombre} - Tienda Virtual`),this.meta.updateTag({name:"description",content:t.meta_description||t.descripcion||`Compra ${t.nombre} al mejor precio`}),this.meta.updateTag({property:"og:title",content:t.nombre}),this.meta.updateTag({property:"og:description",content:t.descripcion||""}),this.meta.updateTag({property:"og:image",content:t.imagen_principal||""}),this.meta.updateTag({property:"og:type",content:"product"}),j(this.platformId)&&this.agregarStructuredData(t)}agregarStructuredData(t){if(j(this.platformId))try{let e={"@context":"https://schema.org/","@type":"Product",name:t.nombre,description:t.descripcion,sku:t.sku,brand:{"@type":"Brand",name:t.marca||"Tienda Virtual"},offers:{"@type":"Offer",price:this.precioActual(),priceCurrency:"PEN",availability:this.stockActual()>0?"https://schema.org/InStock":"https://schema.org/OutOfStock",url:`${window.location.origin}/producto/${t.slug}`},image:t.imagen_principal};if(typeof document<"u"){let n=document.getElementById("product-structured-data");n&&n.remove();let l=document.createElement("script");l.id="product-structured-data",l.type="application/ld+json",l.text=JSON.stringify(e),document.head.appendChild(l)}}catch(e){console.warn("Error al agregar structured data:",e)}}manejarError(t){this._estado.update(e=>O(D({},e),{error:t,cargando:!1})),t.includes("no encontrado")&&setTimeout(()=>{this.router.navigate(["/catalogo"])},3e3)}onImagenSeleccionada(t){let e=this.imagenes();e[t]&&this._estado.update(n=>O(D({},n),{imagenSeleccionada:t,imagenPrincipal:e[t].url}))}onVariacionCambiada(t){this._estado.update(e=>O(D({},e),{variacionSeleccionada:t.variacionSeleccionada,precioActual:t.precioActualizado,stockActual:t.stockActualizado})),t.imagenActualizada&&this._estado.update(e=>O(D({},e),{imagenPrincipal:t.imagenActualizada}))}onAgregarAlCarrito(t){let e=this.producto();if(!e){this.mostrarNotificacionCarrito("Producto no encontrado","error");return}let n={producto_id:e.id,variacion_id:this.variacionSeleccionada()?.id||void 0,cantidad:t.cantidad||1};this.carritoService.agregarItem(n).subscribe({next:l=>{l.success?(this.mostrarNotificacionCarrito("\xA1A\xF1adido al carrito!","success"),console.log("Producto agregado exitosamente al carrito:",l.data)):this.mostrarNotificacionCarrito("Error al agregar producto","error")},error:l=>{console.error("Error al agregar item al carrito:",l),this.mostrarNotificacionCarrito("Error al agregar al carrito","error")}})}onComprarAhora(t){console.log("Comprar ahora:",t),this.router.navigate(["/checkout"],{queryParams:{producto:t.producto.id,variacion:t.variacion?.id,cantidad:t.cantidad}})}volverAlCatalogo(){this.router.navigate(["/catalogo"])}formatearPrecio(t){return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}mostrarNotificacionCarrito(t,e){this._notificacionCarrito.update(n=>O(D({},n),{visible:!0,mensaje:t,tipo:e})),setTimeout(()=>{this._notificacionCarrito.update(n=>O(D({},n),{visible:!1}))},3e3)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["app-producto-detalle"]],standalone:!0,features:[A],decls:11,vars:2,consts:[[1,"min-h-screen","bg-gray-50"],["aria-label","Breadcrumb",1,"bg-white","border-b","border-gray-200"],[1,"container","mx-auto","px-4","py-3"],[1,"flex","items-center","space-x-2","text-sm"],[1,"flex","items-center"],[1,"container","mx-auto","px-4","py-6","md:py-8"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","lg:gap-12"],[1,"text-center","py-12"],[1,"fixed","top-20","right-4","z-50","animate-bounce"],[1,"text-gray-900","font-medium"],[1,"text-gray-500","hover:text-gray-700","transition-colors","duration-200",3,"href"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","mx-2","text-gray-300"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 111.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[1,"space-y-4"],[1,"aspect-square","bg-gray-200","rounded-lg","animate-pulse"],[1,"grid","grid-cols-4","gap-2"],[1,"space-y-6"],[1,"h-8","bg-gray-200","rounded","animate-pulse"],[1,"h-4","bg-gray-200","rounded","w-3/4","animate-pulse"],[1,"h-6","bg-gray-200","rounded","w-1/2","animate-pulse"],[1,"space-y-3"],[1,"h-4","bg-gray-200","rounded","animate-pulse"],[1,"h-4","bg-gray-200","rounded","w-5/6","animate-pulse"],[1,"h-4","bg-gray-200","rounded","w-4/5","animate-pulse"],[1,"h-12","bg-gray-200","rounded","animate-pulse"],[1,"max-w-md","mx-auto"],[1,"text-red-500","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.866-.833-2.464 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-2xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600","mb-6"],["type","button",1,"bg-blue-600","hover:bg-blue-700","text-white","font-medium","py-2","px-6","rounded-lg","transition-colors","duration-200",3,"click"],[1,"order-1"],[3,"imagenCambiada","imagenes","imagenSeleccionada","producto"],[1,"order-2","space-y-6"],[3,"agregarAlCarrito","producto","precioFormateado","precioOfertaFormateado","porcentajeDescuento"],[3,"producto"],[1,"mt-12","lg:mt-16"],[1,"mt-8"],[3,"variacionCambiada","producto"],[1,"px-6","py-3","rounded-lg","shadow-lg","text-white","font-medium","flex","items-center","space-x-2",3,"ngClass"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"nav",1)(2,"div",2)(3,"ol",3),S(4,Fi,3,1,"li",4,Ei),a()()(),o(6,"div",5),u(7,Mi,16,1,"div",6)(8,Ri,11,1,"div",7)(9,Oi,10,10),a()(),u(10,$i,6,6,"div",8)),e&2&&(r(4),w(n.breadcrumbs()),r(3),s(n.cargando()?7:n.error()?8:n.producto()?9:-1),r(3),s(n.notificacionCarrito().visible?10:-1))},dependencies:[M,xe,ae,re,le,de,se]})};export{Me as ProductoDetalleComponent};
