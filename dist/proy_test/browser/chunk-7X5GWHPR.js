import{a as G}from"./chunk-37WS3UMF.js";import{b as _,c as d,d as E,e as F,h as P,k as U,l as N,r as k,s as M,t as z}from"./chunk-C56EV6ZL.js";import{a as S}from"./chunk-PSL723HE.js";import"./chunk-6WUTALT2.js";import{A as y,Aa as i,I as f,Ja as C,V as h,Z as s,ca as m,db as w,ea as g,ga as u,ma as b,ra as t,sa as e,ta as o,va as v,wa as x,z as p}from"./chunk-7RPVYQIG.js";import"./chunk-6MDQTQU3.js";function V(a,r){if(a&1&&o(0,"img",9),a&2){let l=x();u("src",l.usuario().avatar,h)("alt",l.usuario().nombre)}}function D(a,r){a&1&&(f(),t(0,"svg",10),o(1,"path",31),e())}function A(a,r){a&1&&(t(0,"span",18),f(),t(1,"svg",32),o(2,"circle",33)(3,"path",34),e(),i(4," Actualizando... "),e())}function j(a,r){a&1&&i(0," Actualizar perfil ")}function q(a,r){a&1&&(t(0,"span",18),f(),t(1,"svg",32),o(2,"circle",33)(3,"path",34),e(),i(4," Cambiando... "),e())}function I(a,r){a&1&&i(0," Cambiar contrase\xF1a ")}var T=class a{cuentaUsuarioService=p(G);authService=p(S);fb=p(k);usuario=m(null);preferencias=m({notificaciones_email:!0,newsletter:!1});isUpdatingPerfil=m(!1);isUpdatingPassword=m(!1);perfilForm=this.fb.group({nombre:["",[d.required]],email:["",[d.required,d.email]],telefono:[""],fecha_nacimiento:[""]});passwordForm=this.fb.group({password_actual:["",[d.required]],password_nueva:["",[d.required,d.minLength(8)]],password_confirmacion:["",[d.required]]},{validators:this.passwordMatchValidator});ngOnInit(){this.cargarDatosUsuario()}cargarDatosUsuario(){this.cuentaUsuarioService.getPerfilUsuario().subscribe({next:r=>{r.status==="success"&&(this.usuario.set(r.data.usuario),this.preferencias.set(r.data.preferencias),this.perfilForm.patchValue({nombre:r.data.usuario.nombre,email:r.data.usuario.email,telefono:r.data.usuario.telefono,fecha_nacimiento:r.data.usuario.fecha_nacimiento}))}})}actualizarPerfil(){this.perfilForm.valid&&(this.isUpdatingPerfil.set(!0),this.cuentaUsuarioService.actualizarPerfil(this.perfilForm.value).subscribe({next:r=>{r.status==="success"&&this.cargarDatosUsuario(),this.isUpdatingPerfil.set(!1)},error:()=>{this.isUpdatingPerfil.set(!1)}}))}cambiarPassword(){this.passwordForm.valid&&(this.isUpdatingPassword.set(!0),this.cuentaUsuarioService.cambiarPassword(this.passwordForm.value).subscribe({next:r=>{r.status==="success"&&this.passwordForm.reset(),this.isUpdatingPassword.set(!1)},error:()=>{this.isUpdatingPassword.set(!1)}}))}passwordMatchValidator(r){let l=r.get("password_nueva"),n=r.get("password_confirmacion");return l&&n&&l.value!==n.value?(n.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null}static \u0275fac=function(l){return new(l||a)};static \u0275cmp=y({type:a,selectors:[["app-configuracion-cuenta"]],standalone:!0,features:[C],decls:79,vars:9,consts:[[1,"space-y-6"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","p-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"flex","items-center","space-x-4"],[1,"w-16","h-16","bg-gray-200","rounded-full","flex","items-center","justify-center","overflow-hidden"],[1,"w-full","h-full","object-cover",3,"src","alt"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],["type","button",1,"px-3","py-2","bg-gray-100","text-gray-700","text-sm","rounded-lg","hover:bg-gray-200","transition-colors"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","formControlName","nombre",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],["type","email","formControlName","email",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],["type","tel","formControlName","telefono",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],["type","date","formControlName","fecha_nacimiento",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],["type","submit",1,"w-full","px-4","py-2","bg-blue-600","text-white","font-medium","rounded-lg","hover:bg-blue-700","disabled:opacity-50","transition-colors",3,"disabled"],[1,"inline-flex","items-center"],["type","password","formControlName","password_actual",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],["type","password","formControlName","password_nueva",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],[1,"text-xs","text-gray-500","mt-1"],["type","password","formControlName","password_confirmacion",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],["type","submit",1,"w-full","px-4","py-2","bg-green-600","text-white","font-medium","rounded-lg","hover:bg-green-700","disabled:opacity-50","transition-colors",3,"disabled"],[1,"space-y-4"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"relative","inline-flex","items-center","cursor-pointer"],["type","checkbox",1,"sr-only","peer",3,"checked"],[1,"w-11","h-6","bg-gray-200","peer-focus:outline-none","peer-focus:ring-4","peer-focus:ring-blue-300","rounded-full","peer","peer-checked:after:translate-x-full","peer-checked:after:border-white","after:content-['']","after:absolute","after:top-[2px]","after:left-[2px]","after:bg-white","after:border-gray-300","after:border","after:rounded-full","after:h-5","after:w-5","after:transition-all","peer-checked:bg-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(l,n){if(l&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),i(3," Configuraci\xF3n de la cuenta "),e(),t(4,"p",3),i(5," Actualiza tu informaci\xF3n personal y configuraciones "),e()(),t(6,"div",4)(7,"div",1)(8,"h2",5),i(9," Informaci\xF3n personal "),e(),t(10,"form",6),v("ngSubmit",function(){return n.actualizarPerfil()}),t(11,"div",7)(12,"div",8),g(13,V,1,2,"img",9)(14,D,2,0,":svg:svg",10),e(),t(15,"button",11),i(16," Cambiar foto "),e()(),t(17,"div")(18,"label",12),i(19,"Nombre completo"),e(),o(20,"input",13),e(),t(21,"div")(22,"label",12),i(23,"Correo electr\xF3nico"),e(),o(24,"input",14),e(),t(25,"div")(26,"label",12),i(27,"Tel\xE9fono"),e(),o(28,"input",15),e(),t(29,"div")(30,"label",12),i(31,"Fecha de nacimiento"),e(),o(32,"input",16),e(),t(33,"button",17),g(34,A,5,0,"span",18)(35,j,1,0),e()()(),t(36,"div",1)(37,"h2",5),i(38," Cambiar contrase\xF1a "),e(),t(39,"form",6),v("ngSubmit",function(){return n.cambiarPassword()}),t(40,"div")(41,"label",12),i(42,"Contrase\xF1a actual"),e(),o(43,"input",19),e(),t(44,"div")(45,"label",12),i(46,"Nueva contrase\xF1a"),e(),o(47,"input",20),t(48,"p",21),i(49,"M\xEDnimo 8 caracteres"),e()(),t(50,"div")(51,"label",12),i(52,"Confirmar nueva contrase\xF1a"),e(),o(53,"input",22),e(),t(54,"button",23),g(55,q,5,0,"span",18)(56,I,1,0),e()()()(),t(57,"div",1)(58,"h2",5),i(59,"Preferencias"),e(),t(60,"div",24)(61,"div",25)(62,"div")(63,"h3",26),i(64," Notificaciones por email "),e(),t(65,"p",27),i(66," Recibe actualizaciones sobre tus pedidos "),e()(),t(67,"label",28),o(68,"input",29)(69,"div",30),e()(),t(70,"div",25)(71,"div")(72,"h3",26),i(73,"Newsletter"),e(),t(74,"p",27),i(75," Ofertas especiales y promociones "),e()(),t(76,"label",28),o(77,"input",29)(78,"div",30),e()()()()()),l&2){let c;s(10),u("formGroup",n.perfilForm),s(3),b((c=n.usuario())!=null&&c.avatar?13:14),s(20),u("disabled",n.perfilForm.invalid||n.isUpdatingPerfil()),s(),b(n.isUpdatingPerfil()?34:35),s(5),u("formGroup",n.passwordForm),s(15),u("disabled",n.passwordForm.invalid||n.isUpdatingPassword()),s(),b(n.isUpdatingPassword()?55:56),s(13),u("checked",n.preferencias().notificaciones_email),s(9),u("checked",n.preferencias().newsletter)}},dependencies:[w,M,P,_,E,F,z,U,N],encapsulation:2})};export{T as ConfiguracionCuentaComponent};
